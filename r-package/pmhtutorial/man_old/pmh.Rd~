\name{pmh}
\alias{pmh}
\title{
Particle Metropolis-Hastings algorithm for a linear Gaussian state space model
}
\description{
Estimates the parameter posterior for phi a linear Gaussian state 
space model of the form \eqn{ x_{t} = \phi x_{t-1} + \sigma_v v_t } and \eqn{ y_t = x_t + \sigma_e e_t }, where 
\eqn{v_t} and \eqn{e_t} denote independent standard Gaussian random variables, i.e.
\eqn{N(0,1)}.
}
\usage{
pmh(y, initPar, sigmav, sigmae, nPart, T, x0, nIter, stepSize)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{y}{
observations from the model for \eqn{t=1,...,T}.
}
  \item{initPar}{
An inital value for the parameter phi \eqn{\phi}.
}
  \item{sigmav}{
The standard deviation of the state process \eqn{\sigma_v}.
}
  \item{sigmae}{
The standard deviation of the observation process \eqn{\sigma_e}.
}
  \item{nPart}{
The number of particles in the particle filter.
}
\item{T}{
The number of observations.
}
  \item{x0}{
The initial state.
}
  \item{nIter}{
The number of iterations in the PMH algorithm.
}
  \item{stepSize}{
The standard deviation of the Gaussian random walk proposal for \eqn{\phi}.
}
}

\value{
The trace of the Markov chain exploring the marginal posterior for \eqn{\phi}.
}
\references{
Dahlin, J. & Schoen, T. B. "Getting started with particle Metropolis-Hastings for 
inference in nonlinear dynamical models." pre-print, arXiv:1511.01707, 2015.
}
\author{
Johan Dahlin <johan.dahlin@liu.se>
}
\note{
See Section 4.3 in the reference above for more details.
}


\examples{
if(nchar(Sys.getenv("LONG_TEST")) != 0) {nIter=7500} else {nIter=100}

## Generates T=500 observations from a linear state space model with
## ( phi, sigma_e, sigma_v ) = ( 0.5, 1.0, 0.1 ) and zero initial state.

d     <- generateData(phi=0.5, sigmav=1.0, sigmae=0.1, T=500, x0=0.0) 

## Estimate the marginal posterior for phi
res   <- pmh(d$y, initPar=0.1, sigmav=1.0, sigmae=0.1, nPart=50, T=500, 
             x0=0.0, nIter, stepSize=0.10)

## Plot the estimate
hist(res$thhat, main="", xlab=expression(phi), 
     ylab="marginal posterior", freq=FALSE)
}
\keyword{ts}
